# SearXNG + Tavily Adapter — Unified Configuration
#
# IMPORTANT: Copy this file and change settings:
# cp config.example.yaml config.yaml
#
# Required changes:
# - server.secret_key (random 32+ chars)

# =================================
# SearXNG Configuration
# =================================
use_default_settings: true

server:
  secret_key: "CHANGE_ME_TO_RANDOM_SECRET_KEY_32_CHARS_OR_MORE"
  limiter: false  # Disable for API usage
  image_proxy: true

search:
  formats:
    - html
    - json    # Required for API!
    - csv
    - rss

valkey:
  url: redis://redis:6379/0

outgoing:
  request_timeout: 10.0
  max_request_timeout: 15.0

# Engine configuration
# All enabled engines are AVAILABLE for smart selector.
# Only engines listed in adapter.search.default_engines are used by default.
# Smart engine selector picks the best engines per query (see engine_selector.py).
engines:
  # === Primary search engines (used in default queries) ===
  - name: google
    disabled: false
  - name: duckduckgo
    disabled: false
  - name: brave
    disabled: false
  - name: bing
    disabled: true       # Rate-limited, unreliable
  - name: startpage
    disabled: true       # Often blocked

  # === Social & Forums ===
  - name: reddit
    disabled: false
    shortcut: re
  # Reddit OAuth API — requires credentials from https://www.reddit.com/prefs/apps/
  # Old (pre-Nov 2025) keys are grandfathered. New keys require manual approval.
  - name: reddit api
    engine: reddit_api
    disabled: false
    shortcut: ra
    client_id: "YOUR_REDDIT_CLIENT_ID"
    client_secret: "YOUR_REDDIT_CLIENT_SECRET"
    # Reddit OAuth: 1000 req / 10 min. Keep 90/min = 900/10min with buffer.
    rate_limit:
      - max_requests: 90
        interval: 60
  - name: hackernews
    disabled: false
  - name: lemmy communities
    disabled: false
    shortcut: lmc
  - name: lemmy posts
    disabled: false
    shortcut: lmp

  # === Tech & Dev (used by smart selector for programming queries) ===
  - name: github
    disabled: false
    shortcut: gh
  - name: stackoverflow
    disabled: false
    shortcut: so
  - name: npm
    disabled: false
    shortcut: npm
  - name: pypi
    disabled: false
    shortcut: pypi
  - name: docker hub
    disabled: false

  # === App Stores (used by smart selector for mobile/product queries) ===
  - name: google play apps
    disabled: false
    shortcut: gpa
  - name: apple app store
    disabled: false
    shortcut: aps

  # === Video (YouTube reviews, tutorials, audience size) ===
  - name: youtube
    disabled: false
    shortcut: yt

  # === News ===
  - name: google news
    disabled: false
    shortcut: gon

  # === Utilities ===
  - name: currency
    disabled: false
    shortcut: cc
  - name: fdroid
    disabled: false
    shortcut: fd

  # === Academic & Reference (used by smart selector for research queries) ===
  - name: arxiv
    disabled: false
    shortcut: arx
  - name: google scholar
    disabled: false
    shortcut: gs
  - name: wikipedia
    disabled: false
    shortcut: wiki
  - name: wikidata
    engine: wikidata
    disabled: false
    shortcut: wd

  # === Disabled ===
  - name: yacy images
    disabled: true

# =================================
# Tavily Adapter Configuration
# =================================
adapter:
  server:
    host: "0.0.0.0"
    port: 8000

  # Internal Docker URL (same network): "http://searxng:8080"
  # External URL (separate): "http://localhost:8999"
  searxng_url: "http://searxng:8080"

  scraper:
    timeout: 10
    max_content_length: 5000    # Max chars of raw page content
    user_agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"

  search:
    default_max_results: 10
    # Default engines for general queries. Smart selector overrides per query.
    default_engines: "google,duckduckgo,brave,reddit"
    default_categories: "general"
    default_language: "auto"
    safesearch: 1
